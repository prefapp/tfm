## Requirements

| Name | Version |
|------|---------|
| <a name="requirement_terraform"></a> [terraform](#requirement\_terraform) | >= 1.7.0 |
| <a name="requirement_azurerm"></a> [azurerm](#requirement\_azurerm) | >= 4.23.0 |

## Providers

| Name | Version |
|------|---------|
| <a name="provider_azurerm"></a> [azurerm](#provider\_azurerm) | >= 4.23.0 |

## Resources

| Name | Type |
|------|------|
| [azurerm_data_protection_backup_instance_blob_storage.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_protection_backup_instance_blob_storage) | resource |
| [azurerm_data_protection_backup_instance_disk.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_protection_backup_instance_disk) | resource |
| [azurerm_data_protection_backup_instance_kubernetes_cluster.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_protection_backup_instance_kubernetes_cluster) | resource |
| [azurerm_data_protection_backup_instance_mysql_flexible_server.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_protection_backup_instance_mysql_flexible_server) | resource |
| [azurerm_data_protection_backup_instance_postgresql_flexible_server.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_protection_backup_instance_postgresql_flexible_server) | resource |
| [azurerm_data_protection_backup_policy.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_protection_backup_policy) | resource |
| [azurerm_data_protection_backup_policy_blob_storage.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_protection_backup_policy_blob_storage) | resource |
| [azurerm_data_protection_backup_policy_disk.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_protection_backup_policy_disk) | resource |
| [azurerm_data_protection_backup_policy_kubernetes_cluster.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_protection_backup_policy_kubernetes_cluster) | resource |
| [azurerm_data_protection_backup_policy_mysql_flexible_server.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_protection_backup_policy_mysql_flexible_server) | resource |
| [azurerm_data_protection_backup_policy_postgresql.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_protection_backup_policy_postgresql) | resource |
| [azurerm_data_protection_backup_vault.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/data_protection_backup_vault) | resource |
| [azurerm_kubernetes_cluster_extension.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster_extension) | resource |
| [azurerm_kubernetes_cluster_trusted_access_role_binding.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/kubernetes_cluster_trusted_access_role_binding) | resource |
| [azurerm_role_assignment.disk_backup_reader](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_assignment) | resource |
| [azurerm_role_assignment.kubernetes_backup_contributor](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_assignment) | resource |
| [azurerm_role_assignment.kubernetes_cluster_admin](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_assignment) | resource |
| [azurerm_role_assignment.mysql_backup_contributor](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_assignment) | resource |
| [azurerm_role_assignment.mysql_rg_reader](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_assignment) | resource |
| [azurerm_role_assignment.postgresql_backup_contributor](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_assignment) | resource |
| [azurerm_role_assignment.postgresql_ltr_backup](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_assignment) | resource |
| [azurerm_role_assignment.postgresql_rg_reader](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_assignment) | resource |
| [azurerm_role_assignment.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_assignment) | resource |
| [azurerm_role_assignment.vault_backup_contributor_disk](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_assignment) | resource |
| [azurerm_role_assignment.vault_backup_contributor_kubernetes](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_assignment) | resource |
| [azurerm_role_assignment.vault_backup_contributor_mysql](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_assignment) | resource |
| [azurerm_role_assignment.vault_backup_contributor_postgresql](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/role_assignment) | resource |
| [azurerm_client_config.current](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/client_config) | data source |
| [azurerm_kubernetes_cluster.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/kubernetes_cluster) | data source |
| [azurerm_managed_disk.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/managed_disk) | data source |
| [azurerm_resource_group.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/resource_group) | data source |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| <a name="input_backup_resource_group_name"></a> [backup\_resource\_group\_name](#input\_backup\_resource\_group\_name) | Name of the resource group for backups | `string` | n/a | yes |
| <a name="input_blob_instances"></a> [blob\_instances](#input\_blob\_instances) | Map of backup instances for blobs | <pre>map(object({<br/>    instance_blob_name              = string<br/>    storage_account_id              = string<br/>    storage_account_container_names = list(string)<br/>    policy_key                      = string<br/>  }))</pre> | `{}` | no |
| <a name="input_blob_policies"></a> [blob\_policies](#input\_blob\_policies) | Map of backup policies for blobs | <pre>map(object({<br/>    policy_name                            = string<br/>    backup_repeating_time_intervals        = optional(list(string))<br/>    operational_default_retention_duration = optional(string)<br/>    time_zone                              = optional(string)<br/>    vault_default_retention_duration       = optional(string)<br/>    retention_rule = optional(list(object({<br/>      name     = string<br/>      priority = number<br/>      criteria = object({<br/>        absolute_criteria      = optional(string)<br/>        days_of_week           = optional(list(string))<br/>        days_of_month          = optional(list(number))<br/>        months_of_year         = optional(list(string))<br/>        weeks_of_month         = optional(list(string))<br/>        scheduled_backup_times = optional(list(string))<br/>      })<br/>      life_cycle = object({<br/>        data_store_type = string<br/>        duration        = string<br/>      })<br/>    })))<br/>  }))</pre> | `{}` | no |
| <a name="input_disk_instances"></a> [disk\_instances](#input\_disk\_instances) | Map of backup instances for disks | <pre>map(object({<br/>    instance_disk_name = string<br/>    policy_key         = string<br/>  }))</pre> | `{}` | no |
| <a name="input_disk_policies"></a> [disk\_policies](#input\_disk\_policies) | Map of backup policies for disks | <pre>map(object({<br/>    policy_name                     = string<br/>    backup_repeating_time_intervals = list(string)<br/>    default_retention_duration      = string<br/>    time_zone                       = optional(string)<br/>    retention_rule = optional(list(object({<br/>      name     = string<br/>      duration = string<br/>      priority = number<br/>      criteria = object({<br/>        absolute_criteria = optional(string)<br/>      })<br/>    })))<br/>  }))</pre> | `{}` | no |
| <a name="input_kubernetes_instances"></a> [kubernetes\_instances](#input\_kubernetes\_instances) | Map of Kubernetes cluster backup instances | <pre>map(object({<br/>    instance_name                = string<br/>    cluster_name                 = string<br/>    snapshot_resource_group_name = string<br/>    policy_key                   = string<br/>    backup_datasource_parameters = object({<br/>      excluded_namespaces              = optional(list(string))<br/>      excluded_resource_types          = optional(list(string))<br/>      cluster_scoped_resources_enabled = optional(bool)<br/>      included_namespaces              = optional(list(string))<br/>      included_resource_types          = optional(list(string))<br/>      label_selectors                  = optional(map(string))<br/>      volume_snapshot_enabled          = optional(bool)<br/>    })<br/>    extension_configuration = optional(object({<br/>      bucket_name                 = optional(string)<br/>      bucket_resource_group_name  = optional(string)<br/>      bucket_storage_account_name = optional(string)<br/>    }))<br/>  }))</pre> | `{}` | no |
| <a name="input_kubernetes_policies"></a> [kubernetes\_policies](#input\_kubernetes\_policies) | Map of backup policies for Kubernetes clusters | <pre>map(object({<br/>    policy_name                     = string<br/>    backup_repeating_time_intervals = list(string)<br/>    time_zone                       = optional(string)<br/>    default_retention_rule = object({<br/>      life_cycle = object({<br/>        duration        = string<br/>        data_store_type = string<br/>      })<br/>    })<br/>    retention_rule = optional(list(object({<br/>      name     = string<br/>      priority = number<br/>      life_cycle = object({<br/>        data_store_type = string<br/>        duration        = string<br/>      })<br/>      criteria = object({<br/>        absolute_criteria      = optional(string)<br/>        days_of_week           = optional(list(string))<br/>        months_of_year         = optional(list(string))<br/>        weeks_of_month         = optional(list(string))<br/>        scheduled_backup_times = optional(list(string))<br/>      })<br/>    })))<br/>  }))</pre> | `{}` | no |
| <a name="input_mysql_instances"></a> [mysql\_instances](#input\_mysql\_instances) | Map of MySQL Flexible Server backup instances | <pre>map(object({<br/>    instance_name     = string<br/>    server_id         = string<br/>    resource_group_id = string<br/>    policy_key        = string<br/>  }))</pre> | `{}` | no |
| <a name="input_mysql_policies"></a> [mysql\_policies](#input\_mysql\_policies) | Map of backup policies for MySQL Flexible Server | <pre>map(object({<br/>    policy_name                     = string<br/>    backup_repeating_time_intervals = list(string)<br/>    time_zone                       = optional(string)<br/>    default_retention_rule = list(object({<br/>      life_cycle = object({<br/>        duration        = string<br/>        data_store_type = string<br/>      })<br/>    }))<br/>    retention_rule = optional(list(object({<br/>      name     = string<br/>      priority = number<br/>      life_cycle = object({<br/>        data_store_type = string<br/>        duration        = string<br/>      })<br/>      criteria = object({<br/>        absolute_criteria      = optional(string)<br/>        days_of_week           = optional(list(string))<br/>        months_of_year         = optional(list(string))<br/>        weeks_of_month         = optional(list(string))<br/>        scheduled_backup_times = optional(list(string))<br/>      })<br/>    })))<br/>  }))</pre> | `{}` | no |
| <a name="input_policy"></a> [policy](#input\_policy) | List of backup policies | <pre>list(object({<br/>    name                                   = string<br/>    vault_id                               = string<br/>    backup_repeating_time_intervals        = list(string)<br/>    operational_default_retention_duration = string<br/>    retention_rule = list(object({<br/>      name     = string<br/>      duration = string<br/>      criteria = object({<br/>        days_of_week  = optional(list(string))<br/>        days_of_month = optional(list(number))<br/>      })<br/>      life_cycle = object({<br/>        data_store_type = string<br/>        duration        = string<br/>      })<br/>      priority = number<br/>    }))<br/>    time_zone                        = string<br/>    vault_default_retention_duration = string<br/>    retention_duration               = string<br/>  }))</pre> | `[]` | no |
| <a name="input_postgresql_instances"></a> [postgresql\_instances](#input\_postgresql\_instances) | Map of backup instances for PostgreSQL Flexible Server | <pre>map(object({<br/>    instance_name     = string<br/>    server_id         = string<br/>    resource_group_id = string<br/>    policy_key        = string<br/>  }))</pre> | `{}` | no |
| <a name="input_postgresql_policies"></a> [postgresql\_policies](#input\_postgresql\_policies) | Map of backup policies for PostgreSQL Flexible Server | <pre>map(object({<br/>    policy_name                     = string<br/>    backup_repeating_time_intervals = list(string)<br/>    default_retention_duration      = string<br/>    time_zone                       = optional(string)<br/>    retention_rule = list(object({<br/>      name     = string<br/>      duration = string<br/>      priority = number<br/>      criteria = object({<br/>        absolute_criteria      = optional(string)<br/>        months_of_year         = optional(list(string))<br/>        weeks_of_month         = optional(list(string))<br/>        scheduled_backup_times = optional(list(string))<br/>        days_of_week           = optional(list(string))<br/>      })<br/>    }))<br/>  }))</pre> | `{}` | no |
| <a name="input_tags"></a> [tags](#input\_tags) | Tags to apply to resources | `map(string)` | `{}` | no |
| <a name="input_tags_from_rg"></a> [tags\_from\_rg](#input\_tags\_from\_rg) | Use resource group tags as base for module tags | `bool` | `false` | no |
| <a name="input_vault"></a> [vault](#input\_vault) | Backup vault configuration | <pre>object({<br/>    name                         = string<br/>    datastore_type               = string<br/>    redundancy                   = string<br/>    cross_region_restore_enabled = optional(bool)<br/>    retention_duration_in_days   = optional(number)<br/>    immutability                 = optional(string)<br/>    soft_delete                  = optional(string)<br/>    identity = optional(object({<br/>      type = string<br/>    }))<br/>  })</pre> | n/a | yes |

## Outputs

| Name | Description |
|------|-------------|
| <a name="output_vault_id"></a> [vault\_id](#output\_vault\_id) | n/a |
